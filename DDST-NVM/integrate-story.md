---
layout: page
title: 863 结题展示大纲（剧本）
subtitle: 只许成功不许失败
use-site-title: true
---

## 楔子：自我介绍

各位专家老师，大家好。

我是xxx，今天由我来为诸位介绍我们这个863项目内存计算系统的集成情况。

## 第一章：机器介绍

那么，首先做个简要的背景介绍。随着大数据计算与处理技术的发展，内存资源的稀缺与持久化所需的磁盘IO越来越成为系统性能的瓶颈。

随着新型非易失内存 NVM 技术的出现，它的许多优秀特性，如可字节寻址、内存级访问带宽和延迟、持久性等，将使得这些困扰我们的问题成为过去。

当然，我们读过了很多论文和技术概念，但它们都是基于某些假设，用基于 DRAM 的模拟器来做 NVM 相关的研究。

但今天呢，我们要展示的是一个实实在在的非易失内存机器 —— 主板由华为提供，它的内存由 DDR4 DRAM 和 Intel 生产的 AEP (Apache Pass) 组成。

AEP 是 Intel 基于原来提出的 3D XPoint 技术制造的非易失内存硬件，具有与 DDR4 DRAM 相当的带宽和延迟。

现在这台华为的服务器上总共有 128GB + 1TB 的内存空间，其中这个 128GB 是传统的 DRAM 内存，1TB 则是新型非易失内存。

> ixpdimm-cli show -a -goal
> ixpdimm-cli show -memoryresources
> ixpdimm-cli show -a -pool

（如有机会，可以请华为打开机器主板，让专家看内存条的插法并介绍：如果我没记错，应该是 2路 64G DRAM + 8路 128G AEP）

## 第二章：集成系统介绍

我们把内存计算项目的重点成果部署在这台服务器上，进行了相关的调试适配工作。今天要为各位专家展示的成果主要是SCM感知文件系统和新型混合内存管理系统。
这两个系统解决了“数据持久化”、“持久数据管理”和“数据一致性保障”这三个重要问题。

这两个系统利用NVM作为持久化介质，将持久数据以不同的粒度，通过特定的管理手段，保存在NVM中，同时也提供了多模式访问机制。

## 第三章：多模式访问

那么，我们先来看多模式访问机制。
所谓多模式访问，即以不同的粒度和形式访问NVM内存：比如，卷模式，即像Windows系统划分逻辑分区C盘（系统盘）、D盘、E盘那样，在Linux系统中经NVM管理成多个卷，每个卷可以服务于不同的用途和使用场景；内存模式是Load/Store形式的访问；文件模式是以文件为单位的访问。

1. 首先我们来看卷模式（卷模式是一种管理存储区域的方式——它将NVM设备当做硬盘来看待，进行逻辑上的空间管理）。

【需要相应的命令操作】

> ll /dev/pmem*

一开始是没有持久设备（卷）的，我们可以重新创建【将设备pmem等同于卷是否合适呢？是否需要把复旦的工作移植到华为服务器上？需要通读代码——时间代价是？】

2. 接下来我们看文件模式

当以文件粒度访问 NVM 时，我们

## 第四章：SCM 感知文件系统

我们研发的新型持久内存文件系统HMFS。。。

我们先将系统挂载起来。

> umount hmfs

现在我们的机器上没有 hmfs 这个类型的文件系统，接下来

> mkdir /root/yz/hmfs-test (可以省去)
> mount -t hmfs -o physaddr=0x40000000,init=8G none /root/yz/hmfs-test

> df -hT

发现新的文件系统 hmfs 已被添加进来。

接着我们试着在 hmfs 文件系统挂载点下进行相关的文件测试。

> mkdir dirtesta dirtestb dirtestc
> touch ftesta ftestb ftestc
> ll

发现相应的目录和文件已经创建完毕。那么数据读写又表现如何呢？

> echo "this is a good time." >> ftesta
> touch dirtesta/infa | echo "inner write to file" >> infa
> cat ftesta
> cat dirtesta/infa

那么在大量读写负载请求时 hmfs 又表现如何呢？

我们使用 filebench 进行测试：

【相关命令需记录在此】

## 混合内存管理系统
 
我们基于 NVM 研发的混合内存管理系统 Daisy 支持动态的细粒度非易失内存分配，同时兼容原有的易失性内存分配机制。

Daisy 的主要目的是高效地分配非易失内存空间，减少分配的内存碎片，方便地管理持久数据区域，并支持数据一致性和快速故障恢复。

我们准备了一些测试例程来验证 Daisy 的功能和性能指标。

在功能方面，如果我们是要创建一个持久化数据结构，比如

那么是否能够找回呢？

性能指标方面我们采用的传统持久化机制是Redis的RDB快照和AOF日志机制。

## 大数据应用演示

那么最后我们展示两个基于系统软件的大数据应用，分别是 graph500 和 图形计算。。。






